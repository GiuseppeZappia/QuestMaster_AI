<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avventura Misteriosa</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #222;
            color: #eee;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow: hidden; /* Prevent scrolling */
        }

        .container {
            display: flex;
            flex-grow: 1;
            padding: 20px;
        }

        #sidebar {
            width: 250px;
            background-color: #333;
            padding: 20px;
            margin-right: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        #main {
            flex-grow: 1;
            background-color: #444;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            overflow-y: auto; /* Enable vertical scrolling for main content */
            max-height: calc(100vh - 40px); /* Account for padding */
        }

        h1 {
            text-align: center;
            color: #ddd;
            margin-bottom: 20px;
        }

        h2 {
            color: #ccc;
            margin-top: 0;
        }

        p {
            line-height: 1.6;
        }

        #actions {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        button {
            background-color: #555;
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #777;
        }

        #history {
            margin-top: 20px;
            padding: 10px;
            background-color: #333;
            border-radius: 5px;
            overflow-y: auto;
            max-height: 150px;
        }

        #history p {
            margin: 5px 0;
            font-size: 0.9em;
            color: #bbb;
        }

        #progress {
            margin-top: 20px;
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            color: #ddd;
        }

        #resetButton {
            background-color: #800;
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }

        #resetButton:hover {
            background-color: #a00;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            #sidebar {
                width: 100%;
                margin-right: 0;
                margin-bottom: 20px;
            }

            #main {
                max-height: none; /* Allow main content to expand */
            }
        }
    </style>
</head>
<body>
    <h1>Avventura Misteriosa</h1>

    <div class="container">
        <div id="sidebar">
            <h2>Informazioni Quest</h2>
            <p><strong>Titolo:</strong> Avventura Misteriosa</p>
            <p><strong>Descrizione:</strong> Un'epica ricerca nel cuore delle montagne per salvare la principessa.</p>
            <p><strong>Obiettivo:</strong> Salvare la principessa Aurelia e sigillare il drago.</p>
            <div id="progress">Progresso: 0%</div>
            <button id="resetButton">Ricomincia</button>
        </div>

        <div id="main">
            <div id="narrative" class="fade-in"></div>
            <div id="actions"></div>
            <div id="history">
                <h2>Storia</h2>
            </div>
        </div>
    </div>

    <script>
        const narrativeElement = document.getElementById('narrative');
        const actionsElement = document.getElementById('actions');
        const historyElement = document.getElementById('history');
        const progressElement = document.getElementById('progress');
        const resetButton = document.getElementById('resetButton');

        let currentScene = 'inizio';
        let history = [];
        let progress = 0;

        const scenes = {
            'inizio': {
                description: "Ti trovi ai piedi del Cuore Montagna, una vetta imponente avvolta nella leggenda. Il vento ulula portando con sé storie di draghi e principesse rapite. Cosa fai?",
                actions: [
                    { text: "Avventurati verso il Cuore Montagna", nextScene: 'cuore-montagna', actionPDDL: "(move ettore eldoria cuore-montagna)" },
                    { text: "Raccogli informazioni al villaggio", nextScene: 'villaggio', actionPDDL: "ricerca-informazioni" }
                ]
            },
            'cuore-montagna': {
                description: "Sei nel cuore della montagna. Un'eco lontana rivela la presenza di una prigione.  Scrutando nell'oscurità, intravedi una chiave scintillante. Cosa fai?",
                actions: [
                    { text: "Prendi la chiave", nextScene: 'chiave-presa', actionPDDL: "(get-key ettore chiave-luce cuore-montagna)" },
                    { text: "Cerca la principessa", nextScene: 'prigione', actionPDDL: "(rescue-princess ettore aurelia cuore-montagna)" },
                    { text: "Esplora una caverna oscura", nextScene: 'caverna-inizio', actionPDDL: "(move ettore cuore-montagna caverna-fumo-nero)" }
                ]
            },
            'chiave-presa': {
                description: "Hai preso la chiave! Sembra irradiare una luce tenue. Potrebbe essere utile per aprire qualche porta... Ora cosa fai?",
                actions: [
                    { text: "Cerca la principessa", nextScene: 'prigione', actionPDDL: "(rescue-princess ettore aurelia cuore-montagna)" },
                    { text: "Esplora una caverna oscura", nextScene: 'caverna-inizio', actionPDDL: "(move ettore cuore-montagna caverna-fumo-nero)" },
                    { text: "Torna all'inizio della montagna", nextScene: 'cuore-montagna' , actionPDDL: "(move ettore caverna-fumo-nero cuore-montagna)"}
                ]
            },
            'prigione': {
                description: "Trovi la principessa Aurelia rinchiusa in una cella. La chiave che hai trovato apre la serratura! La principessa è salva! 🎉",
                actions: [
                    { text: "Porta la principessa in salvo", nextScene: 'finale-principessa', actionPDDL: "porta-in-salvo" }
                ]
            },
            'caverna-inizio': {
                description: "Entri in una caverna avvolta dal fumo nero. L'aria è pesante e irrespirabile. In fondo, senti un ruggito minaccioso... 🐉",
                actions: [
                    { text: "Affronta il drago", nextScene: 'drago', actionPDDL: "(seal-dragon ettore fumo-nero caverna-fumo-nero)" },
                    { text: "Torna indietro", nextScene: 'cuore-montagna', actionPDDL: "(move ettore caverna-fumo-nero cuore-montagna)" }
                ]
            },
            'drago': {
                description: "Con coraggio, sigilli il drago nel profondo della caverna! Il regno è salvo! 🏆",
                actions: [
                    { text: "Festeggia la tua vittoria!", nextScene: 'finale-drago', actionPDDL: "festeggia" }
                ]
            },
            'villaggio': {
                description: "Gli abitanti del villaggio ti raccontano storie spaventose di un drago e di una principessa rapita. Ti consigliano di cercare una chiave magica nel cuore della montagna.",
                actions: [
                    { text: "Parti per il Cuore Montagna", nextScene: 'cuore-montagna', actionPDDL: "(move ettore eldoria cuore-montagna)" }
                ]
            },
            'finale-principessa': {
                description: "Hai riportato la principessa Aurelia al suo regno. Sei acclamato come un eroe! 🎉 Ma la minaccia del drago incombe ancora...",
                actions: [
                    { text: "Parti per la caverna del drago", nextScene: 'caverna-inizio', actionPDDL: "(move ettore cuore-montagna caverna-fumo-nero)" },
                    { text: "Ricomincia la tua avventura", nextScene: 'inizio'}
                ]
            },
            'finale-drago': {
                description: "Sei un eroe! Hai salvato la principessa e sigillato il drago. Il regno è in festa! 🥳",
                actions: [
                    { text: "Ricomincia la tua avventura", nextScene: 'inizio'}
                ]
            }
        };

        function updateScene(sceneName) {
            currentScene = sceneName;
            const scene = scenes[currentScene];

            narrativeElement.textContent = scene.description;

            // Clear previous actions
            actionsElement.innerHTML = '';

            scene.actions.forEach(action => {
                const button = document.createElement('button');
                button.textContent = action.text;
                button.addEventListener('click', () => {
                    history.push(scene.description + ' Azione: ' + action.text);
                    updateHistory();
                    updateScene(action.nextScene);
                    updateProgress();
                });
                actionsElement.appendChild(button);
            });
        }

        function updateHistory() {
            historyElement.innerHTML = '<h2>Storia</h2>';
            history.forEach(item => {
                const p = document.createElement('p');
                p.textContent = item;
                historyElement.appendChild(p);
            });
             historyElement.scrollTop = historyElement.scrollHeight; // Scroll to bottom
        }

        function updateProgress() {
            progress += 10; // Incremento arbitrario
            if (progress > 100) progress = 100;
            progressElement.textContent = 'Progresso: ' + progress + '%';
        }

        resetButton.addEventListener('click', () => {
            currentScene = 'inizio';
            history = [];
            progress = 0;
            updateScene(currentScene);
            updateHistory();
            updateProgress();
        });

        // Initialize the game
        updateScene(currentScene);
    </script>
</body>
</html>